# 附  录

[yanggy1010@126.com](mailto:yanggy1010@126.com)

[TOC]

## 0. 勘误表

| 页   | 行   | 列   | 错误                                                                  | 更正                                                                  |
| --- | --- | --- | ------------------------------------------------------------------- | ------------------------------------------------------------------- |
| 4   | 5   | 1   | $\rho_{0}e^{- \beta(p - p_{0})}$                                    | $\rho_{0}e^{\beta(p - p_{0})}$                                      |
| 20  | 12  | 20  | $\theta_{2} = 90^{\circ}$                                           | $\theta_{1} = 90^{\circ}$                                           |
| 27  | 4   | 6   | 单位宽度的流量                                                             | 总流量                                                                 |
| 31  | 9   | -6  | $\frac{\partial\rho}{\partial t}$                                   | $\frac{\partial p}{\partial t}$                                     |
| 45  | -1  | -1  | $q = K_{1}\frac{H_{1} - H}{m_{1}}$                                  | $q = - K_{1}\frac{H_{1} - H}{m_{1}}$                                |
| 63  | 4   | 1   | 2.1.1                                                               | 2.2.1                                                               |
| 101 | 1   | -1  | $\int_{0}^{\infty}{\frac{\partial s}{\partial r}rJ_{0}(\beta r)dr}$ | $\int_{0}^{\infty}{\frac{\partial s}{\partial t}rJ_{0}(\beta r)dr}$ |
| 101 | 3   | 1   | $\int_{0}^{\infty}{\frac{\partial s}{\partial r}rJ_{0}(\beta r)dr}$ | $\int_{0}^{\infty}{\frac{\partial s}{\partial t}rJ_{0}(\beta r)dr}$ |
| 107 | 1   | 1   | $\frac{\partial s}{\partial t}$                                     | $\frac{\partial s}{\partial r}$                                     |
| 107 | 2   | 1   | $r\frac{\partial s}{\partial t}$                                    | $r\frac{\partial s}{\partial r}$                                    |
| 111 | 1   | 1   | 图4.6标注数据有误                                                          |                                                                     |
| 112 | -10 | 1   | $- \frac{2.3Q}{4\pi T}$                                             | $- \frac{2.3Q}{2\pi T}$                                             |
| 127 | 6   | 1   | $T = \frac{2.3Q}{2\pi i_{p}}e^{- \frac{r}{B}}$                      | $T = \frac{2.3Q}{4\pi i_{p}}e^{- \frac{r}{B}}$                      |
| 137 | 1   | 1   | $r/D = 0.08$                                                        | $r/D = 0.8$                                                         |
| 137 | -14 | 1   | $r/D = 0.08$                                                        | $r/D = 0.8$                                                         |
| 137 | 5   | -7  | 0.144                                                               | 0.114                                                               |
| 137 | 6   | -7  | 0.114                                                               | 0.144                                                               |

64 页第 14 行 （2.37）式更正为下式，并删除 15～17 行：

$$
\begin{align*}
u(x,t) = & \frac{\Delta(h_{0,t}^{2})}{2}\left\lbrack 1 - \frac{x}{l} - \frac{2}{\pi}\sum\nolimits_{n = 1}^{\infty}\frac{1}{n}\sin\left( \frac{n\pi x}{l} \right)e^{- (\frac{n\pi}{l})^{2}at} \right\rbrack \\
 & + \frac{\Delta(h_{l,t}^{2})}{2}\left\lbrack \frac{x}{l} - \frac{2}{\pi}\sum\nolimits_{n = 1}^{\infty}\frac{(- 1)^{n + 1}}{n}\sin\left( \frac{n\pi x}{l} \right)e^{- (\frac{n\pi}{l})^{2}at} \right\rbrack
\end{align*}
$$

163 页倒数第 5 行（5.39）式更正为 ：

$$
\small
s = \frac{Q}{4\pi T}
\left\lbrace
\frac{4\pi}{l}\sqrt{\frac{Tt}{S}}f(\lambda) + 
ln
\left(
\frac{e^{\frac{2\pi y}{l}}}{4
\left\lbrack \cosh\frac{\pi y}{l} - \cos\frac{\pi(x + a)}{l} \right\rbrack
\left\lbrack \cosh\frac{\pi y}{l} - \cos\frac{\pi(x - a)}{l} \right\rbrack} 
\right) 
\right\rbrace
$$


170 页第 10 行公式更正为：

$$
\small
D = \frac{m_{2}}{\frac{1}{2a_{2}}\left( 2\lg\frac{4m_{2}}{r_{w}} - A_{2} \right) - \lg\frac{4m_{2}}{R}}
$$

$$
\small
s(r,t) = \frac{Q}{4\pi T}\left[W(u) + \xi_{b}\left(u,\frac{l}{M},\frac{r}{M}\right)\right]
$$

## A. 地下水运动方程的柱坐标形式

设 $h(x,y)$ 的所有二阶偏导数连续，由直角坐标与极坐标的关系：

$$
\left\{
\begin{array}{ll}
x & = r\cos\theta \\
y & = r\sin\theta
\end{array}
\right. \quad \Longrightarrow \quad 
\left\{\begin{array}{ll}
r & = \sqrt{x^{2} + y^{2}} \\
\theta & = \arctan\frac{y}{x}
\end{array}
\right.  
$$

$$
\left\{\begin{array}{ll}
\frac{\partial r}{\partial x} & = \frac{x}{r} = \cos\theta \\
\frac{\partial r}{\partial y} & = \frac{y}{r} = \sin\theta
\end{array} \right., \quad \left\{ \begin{array}{ll}
\frac{\partial\theta}{\partial x} & = - \frac{\sin\theta}{r} \\
\frac{\partial\theta}{\partial y} & = \frac{\cos\theta}{r}
\end{array} \right. 
$$

根据复合函数的求导法则：

$$
\small
\begin{gather*}
\frac{\partial H}{\partial x} = \frac{\partial H}{\partial r}\frac{\partial r}{\partial x} + \frac{\partial H}{\partial\theta}\frac{\partial\theta}{\partial x} = \cos\theta\frac{\partial H}{\partial r} - \frac{\sin\theta}{r}\frac{\partial H}{\partial\theta} \\
\frac{\partial H}{\partial y} = \frac{\partial H}{\partial r}\frac{\partial r}{\partial y} + \frac{\partial H}{\partial\theta}\frac{\partial\theta}{\partial y} = \sin\theta\frac{\partial H}{\partial r} + \frac{\cos\theta}{r}\frac{\partial H}{\partial\theta}
\end{gather*}
$$

$$
\small
\begin{align*}
\frac{\partial^{2}H}{\partial x^{2}} & = \frac{\partial}{\partial r}\left( \frac{\partial H}{\partial x} \right)\frac{\partial r}{\partial x} + \frac{\partial}{\partial\theta}\left( \frac{\partial H}{\partial x} \right)\frac{\partial\theta}{\partial x} \\
 & = \frac{\partial}{\partial r}\left( \cos\theta\frac{\partial H}{\partial r} - \frac{\sin\theta}{r}\frac{\partial H}{\partial\theta} \right)\cos\theta + \frac{\partial}{\partial\theta}\left( \cos\theta\frac{\partial H}{\partial r} - \frac{\sin\theta}{r}\frac{\partial H}{\partial\theta} \right)\left( - \frac{\sin\theta}{r} \right) \\
 & = \cos^{2}\theta\frac{\partial^{2}H}{\partial r^{2}} + \frac{2\sin\theta\cos\theta}{r^{2}}\frac{\partial H}{\partial\theta} - \frac{2\sin\theta\cos\theta}{r}\frac{\partial^{2}H}{\partial r\partial\theta} + \frac{\sin^{2}\theta}{r}\frac{\partial H}{\partial r} + \frac{\sin^{2}\theta}{r^{2}}\frac{\partial^{2}H}{\partial\theta^{2}} 
\end{align*}
$$

同理：

$$
\small
\frac{\partial^{2}H}{\partial y^{2}} = \sin^{2}\theta\frac{\partial^{2}H}{\partial r^{2}} - \frac{2\sin\theta\cos\theta}{r^{2}}\frac{\partial H}{\partial\theta} + \frac{2\sin\theta\cos\theta}{r}\frac{\partial^{2}H}{\partial r\partial\theta} + \frac{\cos^{2}\theta}{r}\frac{\partial H}{\partial r} + \frac{\cos^{2}\theta}{r^{2}}\frac{\partial^{2}H}{\partial\theta^{2}}
$$

因此

$$
\small
\begin{align*}
\frac{S}{T}\frac{\partial H}{\partial t} &= \frac{\partial^{2}H}{\partial x^{2}} + \frac{\partial^{2}H}{\partial y^{2}} = \frac{\partial^{2}H}{\partial r^{2}} + \frac{1}{r}\frac{\partial H}{\partial r} + \frac{1}{r^{2}}\frac{\partial^{2}H}{\partial\theta^{2}} \\
 &= \frac{1}{r^{2}}\left\lbrack r\frac{\partial}{\partial r}\left( r\frac{\partial H}{\partial r} \right) + \frac{\partial^{2}H}{\partial\theta^{2}} \right\rbrack
\end{align*}
$$

## B. Boussinesq 方程的线性化

Boussinesq 方程：

$$
\frac{\partial}{\partial x}\left( Kh\frac{\partial h}{\partial x} \right) + W = \mu\frac{\partial h}{\partial t}
$$

- 第一种线性化方法：

如果 $h$ 变化不大，用平均值 $\bar{h}$ 代替 $Kh$：

$$
K\bar{h}\frac{\partial^2 h}{\partial x^2}+W=\mu \frac{\partial h}{\partial t}\tag{b-1}
$$

- 第二种线性化方法：

令 $u=\frac{h^2}{2}$ ， $\frac{\partial h}{\partial t}=\frac{1}{h}\frac{\partial u}{\partial t}$ ，有

$$
K\frac{\partial^2u}{\partial x^2}+W=\frac{\mu}{h}\frac{\partial u}{\partial t}
$$

$h$ 取平均值 $\bar{h}$：

$$
K\bar{h}\frac{\partial^2u}{\partial x^2}+W\bar{h}=\mu\frac{\partial u}{\partial t}\tag{b-2}
$$

## C. 分离变量法

### C1. 1 维扩散方程的定解问题

$$
\left\{
\begin{array}{lll}
  \dfrac{\partial u}{\partial t} =a \dfrac{\partial^2 u}{\partial x^2} &  0 \le x \le l,~t>0 \\
  \mathrm{IC:}u(x,0)=\varphi (x) & 0 \le x \le l  \\  
  \mathrm{BC:}u(0,t)=u(l,t)=0 & t>0
\end{array}\right.  \tag{C-I}
$$

设 $u(x,t)=X(x)T(t)$ ，代入方程，有

$$
X(x)T'(t)=a X''(x)T(t)
$$

因为 $x$ 与 $t$ 为两个独立的自由变量，有

$$
\frac{X''}{X}=\frac{T'}{aT}=-\lambda^2
$$

得到两个常微分方程：

$$
T'(t)+ \lambda^2 a T(t)=0  \tag{c-1}
$$

$$
X''(x)+\lambda^2 X(x)=0 \tag{c-2}
$$

方程（c-1）的解：

$$
T(t)= C {\rm e}^{-\lambda^2 a t}
$$

方程（c-2）与问题（ $\mathrm{C-I}$ ）的边界条件构成常微分方程的边值问题：

$$
\left\{
\begin{array}{l}
   X''(x)+\lambda^2 X(x)=0  \\
   X(0)=X(l)=0  \\
\end{array}
\right. \tag{c-3}
$$

问题（c-3）的通解为

$$
X(x)=A\cos(\lambda x)+B \sin(\lambda x)
$$

根据边界条件确定常系数：

$$
\begin{array}{lll}
   X(0)=0 & \implies & A=0 \\
   X(l)=0 & \implies & B\sin(\lambda l)=0 \\
\end{array}
$$

为求非零解，必须  $\sin(\lambda l)=0$ ，有

$$
\lambda_n=\frac{n\pi}{l},~n=1,2,\cdots
$$

综上，问题（$\mathrm{C}$-$\mathrm{I}$）的解为：

$$
u(x,t)= \sum_{n=1}^\infty b_n \sin(\lambda_nx){\rm e}^{-\lambda_n^2 a t} \tag{c-4}
$$

式中， $\lambda_n=\dfrac{n\pi}{l}(n=1,2,\cdots)$。

- 几个重要积分：

$$
\int_{0}^{l}\sin\left(m\pi x/l\right)\sin\left(\frac{n\pi x}{l}\right){\rm d}x =
\left\{\begin{array}{l}
   0 & m\neq n  \\
   \dfrac{l}{2} & m=n  \\
\end{array} \right. \tag{c-5}
$$

$$
\int_{0}^{l}\cos\left(\frac{m\pi x}{l}\right)\cos\left(\frac{n\pi x}{l}\right){\rm d}x =
\left\{\begin{array}{l}
   0 & m\neq n  \\
   \dfrac{l}{2} & m=n  \\
\end{array} \right. \tag{c-6}
$$

$$
\int_{0}^{l}\cos\left(\frac{m\pi x}{l}\right){\rm d}x =
\left\{\begin{array}{l}
   0 & m\neq 0  \\
   l & m=0  \\
\end{array} \right. \tag{c-7}
$$

$$
\int_{0}^{l}\sin^2\left(\frac{m\pi x}{l}\right){\rm d}x =
\int_{0}^{l}\cos^2\left(\frac{m\pi x}{l}\right){\rm d}x = \frac{l}{2},~~m\geq 1 \tag{c-8}
$$

- 确定（c-4）的系数 $b_n$：

由初始条件有

$$
u(x,0)=\varphi(x)=\sum_{n=1}^\infty b_n\sin
\left(\frac{n\pi x}{l}\right)
$$

两边同乘以 $\sin\left(\dfrac{m\pi x}{l}\right)$ ，并从 0 到 $l$ 积分：

$$
\int_0^l \varphi(x)\sin\left(\frac{m\pi x}{l}\right){\rm d}x=
\sum_{n=1}^\infty \int_0^l b_n\sin\left(\frac{m\pi x}{l}\right)\sin\left(\frac{n\pi x}{l}\right){\rm d}x
$$

应用公式（c-5），有

$$
b_n=\frac{2}{l}\int_0^l\varphi(x)\sin\left(\frac{n\pi x}{l}\right){\rm d}x=\frac{2}{l}\int_0^l\varphi(x)\sin(\lambda_n x){\rm d}x \tag{c-9}
$$

式中， $\lambda_n=\dfrac{n\pi}{l},\,n=1,2,\cdots$

### C2. 其他定解问题

$$
\left\{
\begin{array}{lll}
 \dfrac{\partial u}{\partial t} =a \dfrac{\partial^2 u}{\partial x^2} & 0 \le x \le l,~t>0 \\
 \mathrm{IC:}u(x,0)=\varphi_1(x) & 0 \le x \le l \\
 \mathrm{BC:}u(0,t)=u_1,~~u(l,t)=u_2 & t>0 \\
\end{array}\right. \tag{C-II}
$$

设 $v(x,t)=u(x,t)-(1-\frac{x}{l}) u_1-\frac{x}{l} u_2$ ，则 $v(x,t)$ 是如下问题的解：

$$
\left\{
\begin{array}{ll}
  \dfrac{\partial v}{\partial t} =a \dfrac{\partial^2v}{\partial x^2} &  0 \le x \le l,~t>0 \\
  \mathrm{IC:}v(x,0)=\varphi(x) & 0 \le x \le l  \\
  \mathrm{BC:}v(0,t)=0,~~v(l,t)=0 & t>0  \\
\end{array}\right.
$$

式中， $\varphi(x)=\varphi_1(x) - (1-\dfrac{x}{l})u_1-\dfrac{x}{l}u_2 $。该问题同问题（$\mathrm{I}$）一致，可用分离变量法求解。

- $\varphi_1(x)=0$：

$$
\varphi(x)=- (1-\dfrac{x}{l})u_1-\dfrac{x}{l}u_2
$$

此时，问题（$\mathrm{C}$-$\mathrm{II}$）的解为：

$$
u(x,t)= (1-\frac{x}{l})u_1+\frac{x}{l}u_2+ \sum_{n=1}^\infty b_n \sin (\lambda_n x){\rm e}^{-\lambda_n^2 a t}

$$

式中，

$$
b_n=\frac{2}{l}\int_0^l\varphi(x)\sin(\lambda_n x){\rm d}x ,\quad \lambda_n=\dfrac{n\pi}{l}(n=1,2,\cdots)
$$

- 计算系数 $b_n$：

记

$$
c_n = -\frac{2u_1}{l}\int_0^l\left(1-\frac{x}{l}\right) \sin(\lambda_nx){\rm d}x,~d_n = -\frac{2u_2}{l}\int_0^l\frac{x}{l} \sin(\lambda_nx){\rm d}x
$$

分两步计算

1. 先计算 $c_n,\,d_n$
   
   $$
   \begin{split}
c_n & =\frac{2u_1}{l}\frac{1}{\lambda_n}\int_0^l\left(1-\frac{x}{l}\right){\rm d}\cos(\lambda_nx)\\
& =\frac{2u_1}{n\pi}\left.\left[\left(1-\frac{x}{l}\right)\cos(\lambda_nx)\right]\right|_0^l-\frac{2u_1}{n\pi}
\int_0^l\cos(\lambda_nx)(-\frac{1}{l}){\rm d}x \\
& = - \frac{2u_1}{n\pi}\\
d_n & =\frac{2u_2}{l}\frac{1}{\lambda_n}\int_0^l\frac{x}{l}{\rm d}\cos(\lambda_nx)\\
& =\frac{2u_2}{n\pi}\left.\left[\frac{x}{l}\cos(\lambda_nx)\right]\right|_0^l-\frac{2u_2}{n\pi}
\int_0^l\cos(\lambda_nx)\frac{1}{l}{\rm d}x \\
& = \frac{2u_2}{n\pi}(-1)^n\end{split}
   $$

2. 再计算系数 $b_n$：
   
   $$
   b_n=c_n+d_n=-\left[\frac{2u_1}{n\pi}+\frac{2u_2}{n\pi}(-1)^{n+1}\right]
   $$

无量纲变换

记 $\bar{x}=\dfrac{x}{l},~\bar{t}=\dfrac{at}{l^2}$ ，则

$$
\begin{split}
u(x,t)&=u_1\left[ 1-\bar{x}-
  \frac{2}{\pi}\sum_{n=1}^\infty \frac{1}{n} \sin(
  n\pi \bar{x}){\rm e}^{-(n\pi)^2\bar{t}}\right]\\
  & +u_2\left[ \bar{x}-\frac{2}{\pi}\sum_{n=1}^\infty \frac{(-1)^{n+1}}{n} \sin(
  n\pi \bar{x}){\rm e}^{-(n\pi)^2\bar{t}}\right]\\
\end{split}
$$

记

$$
\begin{split}
F(\bar{x},\bar{t})& = 1-\bar{x}-
  \frac{2}{\pi}\sum_{n=1}^\infty \frac{1}{n} \sin(
  n\pi \bar{x}){\rm e}^{-(n\pi)^2\bar{t}} \\
F'(\bar{x},\bar{t}) & = \bar{x}-\frac{2}{\pi}\sum_{n=1}^\infty \frac{(-1)^{n+1}}{n} \sin(
  n\pi \bar{x}){\rm e}^{-(n\pi)^2\bar{t}}
\end{split}
$$

有 $F'(\bar{x},\bar{t})=F(1-\bar{x},\bar{t})$。

定解问题（$\mathrm{C}$-$\mathrm{II}$）的解简记为：

$$
u(x,t)=u_1F(\bar{x},\bar{t})+u_2F'(\bar{x},\bar{t}) \tag{c-10}
$$

- 求 $F(\bar{x},\bar{t})$ 的 VBA 程序：

```python
Function FF(x,t,nmax)
  If t<=0 Then
    FF=0#
  Else
    Pi=3.141592654
    FF=1-x
    For n=1 To nmax
      alpha=n*Pi
      term=-2*Sin(alpha*x)*Exp(-t*alpha^2)/alpha
      FF=FF+term
    Next n
  End If
End Function
```

- 问题（$\mathrm{C}$-$\mathrm{II}$）中 $l\rightarrow \infty$：

$$
\left\{
\begin{array}{lll}
  \dfrac{\partial u}{\partial t} =a \dfrac{\partial^2 u}{\partial x^2} &  0 \le x \le\infty,~t>0 \\
  \mathrm{IC:}u(x,0)=0 & 0 \le x \le \infty  \\
  \mathrm{BC:}u(0,t)=u_1,~~u(\infty,t)=0 & t>0  \\  
\end{array}\right.  \tag{C-III}
$$

若 $l$ 为有限值，则

$$
u(x,t)=u_1\left[ 1-\frac{x}{l}-
  \frac{2}{\pi}\sum_{n=1}^\infty \frac{1}{n} \sin(\frac{n\pi}{l}x){\rm e}^{-(\frac{n\pi}{l})^2at}\right]
$$

记 $\xi_n=\dfrac{n\pi}{l}$ ， $\Delta \xi_n =  \xi_{n+1}-\xi_n = \dfrac{\pi}{l} $ ，有

$$
\frac{u}{u_1}=1-\frac{x}{l}-\frac{2}{\pi}\sum_{n=1}^\infty\frac{\sin(\xi_nx)}{\xi_n}{\rm e}^{-\xi_n^2 at}\Delta \xi_n
$$

当  $l \to \infty $ 时， $\Delta \xi_n\to 0 $ , 上式写成积分形式：

$$
\frac{u}{u_1}=1-\frac{2}{\pi}\int_0^\infty\frac{\sin(\xi x)}{\xi}{\rm e}^{-\xi^2 at}{\rm d}\xi \tag{c-11}
$$

- 几个重要积分：

$$
{\rm erf}(x)  =\frac{2}{\sqrt{\pi}}\int_0^x{\rm e}^{-u^2}{\rm d}u \tag{c-12}
$$

$$
{\rm erfc}(x) =\frac{2}{\sqrt{\pi}}\int_x^\infty{\rm e}^{-u^2}{\rm d}u=1-{\rm erf}(x)\tag{c-13}
$$

$$
\int_0^\infty {\rm e}^{-x^2}{\rm d}x  =\frac{\sqrt{\pi}}{2}\tag{c-14}
$$

$$
\int_0^\infty e^{-a^2x^2}\cos(bx){\rm d}x  =\frac{\sqrt{\pi}}{2a}e^{-\frac{b^2}{4a^2}},~~(a>0)\tag{c-15}
$$

$$
\int_0^\infty \frac{\sin(bx)}{x}{\rm e}^{-a^2x^2}{\rm d}x  =\frac{\pi}{2}{\rm erf}\left(\frac{b}{2a}\right)\tag{c-16}
$$

- 公式（c-15）证明：

记

$$
\varphi(x)=\int_0^\infty e^{-t^2}\cos(2tx){\rm d}t
$$

$$
\begin{split}
\frac{{\rm d}\varphi}{{\rm d}x} & = -2\int_0^\infty te^{-t^2}\sin(2tx){\rm d}t \\
& = \left[e^{-t^2}\sin(2tx)\right]_0^\infty - 2x\int_0^\infty e^{-t^2}\cos(2tx){\rm d}t\\
& = -2x\int_0^\infty e^{-t^2}\cos(2tx)dt
\end{split}
$$

因此， $\varphi$ 满足如下方程：

$$
\frac{{\rm d}\varphi}{{\rm d}x}+2x\varphi=0 \tag{c-17}
$$

方程（c-17）通解为

$$
\varphi(x)=C e^{-x^2}
$$

并且满足

$$
\varphi(0)=\int_0^\infty {\rm e}^{-t^2}{\rm d}t=\frac{\sqrt{\pi}}{2}
$$

有

$$
\varphi(x)=\int_0^\infty {\rm e}^{-t^2}\cos(2tx){\rm d}t=\frac{\sqrt{\pi}}{2}{\rm e}^{-x^2}
$$

取 $t=au(a>0),~x=\frac{b}{2a}$ ，则有

$$
\int_0^\infty {\rm e}^{-a^2u^2}\cos(bu){\rm d}u  =\frac{\sqrt{\pi}}{2a}{\rm e}^{-\frac{b^2}{4a^2}},~~(a>0)
$$

- 公式（c-16）证明：

（c-15）两边分别对 $b$ 从 0 到 $\beta$ 积分：

$$
\begin{split}\int_0^\infty {\rm e}^{-a^2x^2}\frac{\sin\beta x}{x}{\rm d}x & =\frac{\sqrt{\pi}}{2a}\int_0^\beta {\rm e}^{-\frac{b^2}{4a^2}}{\rm d}b \\
& = \frac{\pi}{2}{\rm erf}\left(\frac{\beta}{2a}\right)
\end{split}
$$

即

$$
\int_0^\infty \frac{\sin(bx)}{x}{\rm e}^{-a^2x^2}{\rm d}x  =\frac{\pi}{2}{\rm erf}\left(\frac{b}{2a}\right)
$$

- 问题（$\mathrm{C}$ -$\mathrm{III}$）的解：

由公式（c-15），公式（c-11）变为：

$$
\begin{split}
\frac{u}{u_1}&=1-\frac{2}{\pi}\int_0^\infty\frac{\sin(\xi x)}{\xi}{\rm e}^{-\xi^2 at}{\rm d}\xi \\
& = 1-{\rm erf}\left(\frac{x}{2\sqrt{at}}\right)= {\rm erfc}\left(\frac{x}{2\sqrt{at}}\right)
\end{split}
$$

因此，问题（$\mathrm{C}$ -$\mathrm{III}$）的解为

$$
u(x,t)=u_1  {\rm erfc}\left(\frac{x}{2\sqrt{at}}\right) \tag{c-18}
$$

## D. Bessel 方程与 Bessel 函数

Bessel 方程 ：

$$
x^2\frac{d^2y}{dx^2}+x\frac{dy}{dx}+(x^2-n^2)y=0\tag{d-1}
$$

具有如下形式的解：

$$
y(x)=C_1J_n(x)+C_2Y_n(x)\tag{d-2}
$$

式中， $J_n(x)$ 为第一类贝塞尔函数， $Y_n(x)$ 为第二类贝塞尔函数。

修正贝塞尔方程：

$$
x^2\frac{d^2y}{dx^2}+x\frac{dy}{dx}-(x^2+n^2)y=0\tag{d-3}
$$

具有如下形式的解：

$$
y(x)=C_1I_n(x)+C_2K_n(x)\tag{d-4}
$$

式中， $I_n(x)$ 为第一类修正贝塞尔函数， $K_n(x)$ 为第二类修正贝塞尔函数。

贝塞尔函数（Bessel Functions） 是一类特殊函数的总称。

早在 18 世纪中叶，瑞士数学家丹尼尔·伯努利在研究悬链振动时提出了贝塞尔函数的几个正整数阶特例，当时引起了数学界的兴趣。丹尼尔的叔叔雅各布 · 伯努利，欧拉、拉格朗日等数学大师对贝塞尔函数的研究作出过重要贡献。1817 年，德国数学家贝塞尔在研究开普勒提出的三体引力系统的运动问题时，第一次系统地提出了贝塞尔函数的总体理论框架，后人以他的名字来命名了这种函数。

- 第一类贝塞尔函数 $J_n(x)$ 的形状：

<img title="" src="figures\Bessel-Jn.png" alt="" width="350" data-align="center">

$J_n(x)$-的形状大致与按 $\frac{1}{\sqrt{x}}$ 速率衰减的正弦或余弦函数类似，零点不是周期性的，而是随着 $x$ 的增加零点的间隔会越来越接近周期性。

- 第二类贝塞尔函数 $Y_n(x)$ 的形状：

<img title="" src="figures\Bessel-Yn.png" alt="" width="350" data-align="center">

$Y_n(x)$ 又称诺伊曼函数（Neumann function）， $x=0$ 点是它的无穷奇点。

- 第一类修正贝塞尔函数 $I_n(x)$ 的形状：

<img title="" src="figures\Bessel-In.png" alt="" width="350" data-align="center">

$I_n(x)$ 是指数增长的。

- 第二类修正贝塞尔函数 $K_n(x)$ 的形状：

<img title="" src="figures\Bessel-Kn.png" alt="" width="350" data-align="center">

$K_n(x)$ 是指数衰减的。

- 贝塞尔函数的性质：

| $J_{n}(x)$                                                 | $Y_{n}(x) $                                                |
|:---------------------------------------------------------- | ---------------------------------------------------------- |
| $J_{-n}(x)=(-1)^nJ_n(x),~(n\text{为整数})$                    | $Y_{-n}(x)=(-1)^nY_n(x),~(n\text{为整数})$                    |
| $J_{n-1}(x)+J_{n+1}(x) = \frac{2n}{x}J_{n}(x)$             | $Y_{n-1}(x)+Y_{n+1}(x) = \frac{2n}{x}Y_{n}(x)$             |
| $J_{n-1}(x)-J_{n+1}(x) = 2 J'_n(x)$                        | $Y_{n-1}(x)-Y_{n+1}(x) = 2 Y'_n(x)$                        |
| $\frac{{\rm d}}{{\rm d}x}[x^{-n}J_n(x)]=-x^{-n}J_{n+1}(x)$ | $\frac{{\rm d}}{{\rm d}x}[x^{-n}Y_n(x)]=-x^{-n}Y_{n+1}(x)$ |
| $\frac{{\rm d}}{{\rm d}x}[x^nJ_n(x)]=x^nJ_{n-1}(x)$        | $\frac{{\rm d}}{{\rm d}x}[x^nY_n(x)]=x^nY_{n-1}(x)$        |
| $\frac{{\rm d}}{{\rm d}x}[J_0(x)]=-J_1(x)$                 | $\frac{{\rm d}}{{\rm d}x}[Y_0(x)]=-Y_1(x)$                 |

| $I_{n}(x)$                                                | $K_{n}(x) $                                                |
|:--------------------------------------------------------- | ---------------------------------------------------------- |
| $I_{-n}(x)=I_n(x),~(n\text{为整数})$                         | $K_{-n}(x)=K_n(x),~(n\text{为整数})$                          |
| $I_{n-1}(x)-I_{n+1}(x) = \frac{2n}{x}I_{n}(x)$            | $K_{n-1}(x)- K_{n+1}(x) = -\frac{2n}{x}K_{n}(x)$           |
| $I_{n-1}(x)+I_{n+1}(x) =2 I'_n(x)$                        | $K_{n-1}(x)+ K_{n+1}(x) =-2K'_n(x)$                        |
| $\frac{{\rm d}}{{\rm d}x}[x^{-n}I_n(x)]=x^{-n}I_{n+1}(x)$ | $\frac{{\rm d}}{{\rm d}x}[x^{-n}K_n(x)]=-x^{-n}K_{n+1}(x)$ |
| $\frac{{\rm d}}{{\rm d}x}[x^nI_n(x)]=x^nI_{n-1}(x)$       | $\frac{{\rm d}}{{\rm d}x}[x^nK_n(x)]=-x^nK_{n-1}(x)$       |
| $\frac{{\rm d}}{{\rm d}x}[I_0(x)]=I_1(x)$                 | $\frac{{\rm d}}{{\rm d}x}[K_0(x)]=-K_1(x)$                 |

- 贝塞尔函数的渐进性质：

| $x\to0$                                                                  | $x\to\infty$                                                                              |
|:------------------------------------------------------------------------ | ----------------------------------------------------------------------------------------- |
| $J_n(x)\approx \frac{1}{\Gamma(1+n)}\left(\frac{x}{2}\right)^n,~n\geq 0$ | $J_n(x)\approx \sqrt{\frac{2}{\pi x}}\cos \left(x- \frac{n\pi}{2}-\frac{\pi}{4}\right)$   |
| $Y_0(x)\approx\frac{2}{\pi}\ln(x)$                                       | $ Y_n(x)\approx \sqrt{\frac{2}{\pi x}}\sin \left (x- \frac{n\pi}{2}-\frac{\pi}{4}\right)$ |
| $Y_n(x)\approx -\frac{\Gamma(n)}{\pi}\left(\frac{2}{x} \right)^n,~n>0$   | $I_n(x)\approx\frac{1}{\sqrt{2\pi x}}e^x$                                                 |
| $I_n(x)\approx \frac{1}{\Gamma(1+n)}\left(\frac{x}{2}\right)^n$          | $K_n(x)\approx\sqrt{\frac{\pi}{2x}}e^{-x}$                                                |
| $K_0(x)\approx -\ln x$                                                   |                                                                                           |
| $K_n(x)\approx \frac{\Gamma(n)}{2}\left(\frac{2}{x}\right)^n,~n>0$       |                                                                                           |

## E. Theis 模型的不同解法

记 $ s= H_0-H $ ，数学模型：

$$
\left\{
\begin{array}{ll}
  a\left(\frac{\partial^2{s}}{\partial{r^2}}+\frac{1}{r}\frac{\partial{s}}{\partial{r}}\right)=
  \frac{\partial{s}}{\partial{t}}&t>0,~0<r<\infty\\
  \mathrm{IC:}s(r,0)=0&0<r<\infty\\
  \mathrm{BC:}\lim\limits_{r\to\infty}s(r,t)=0&t>0\\
  \mathrm{BC:}\lim\limits_{r\to\infty }  \frac{\partial{s}}{\partial{r}}=0&t>0\\
  \mathrm{BC:}\lim\limits_{r\to 0} r\frac{\partial{s}}{\partial{r}}=-\frac{Q}{2\pi T}&t>0\\
\end{array}
\right.\tag{E-I}
$$

式中， $a=\frac{T}{S}$。

### E1. Bolttzmann 变换法

引入变量 $u=\frac{r^2}{4at}$ ，则有

$$
\frac{\partial u}{\partial r}=\frac{r}{2at},\quad \frac{\partial u}{\partial t}=-\frac{u}{t}
$$

依据求导的链式法则，有

$$
\begin{split}
\frac{\partial s}{\partial r}&= \frac{{\rm d}s}{{\rm d}u}\frac{\partial u}{\partial r}=\frac{{\rm d}s}{{\rm d}u}\frac{r}{2at}\\
\frac{\partial^2 s}{\partial r^2}&= \frac{1}{2at}\frac{{\rm d}s}{{\rm d}u}+\left(\frac{r}{2at}\right)^2\frac{{\rm d}^2 s}{{\rm d}u^2}\\
\frac{\partial s}{\partial t}&= \frac{{\rm d}s}{{\rm d}u}\frac{\partial u}{\partial t}=-\frac{{\rm d}s}{{\rm d}u}\frac{u}{t}\\
\end{split}
$$

代入偏微分方程：

$$
a\left[\frac{1}{2at}\frac{{\rm d}s}{{\rm d}u}+\left(\frac{r}{2at}\right)^2\frac{{\rm d}^2s}{{\rm d}u^2}+\frac{1}{2at}\frac{{\rm d}s}{{\rm d}u} \right]=-\frac{u}{t}\frac{{\rm d}s}{{\rm d}u}
$$

整理得：

$$
u\frac{{\rm d}^2s}{{\rm d}u^2}+(1+u)\frac{{\rm d}s}{{\rm d}u}=0
$$

由初始条件与边界条件：

$$
\begin{cases}
\underset{u\to \infty }{\mathop{\lim }}s=0\\
\underset{u\to0}{\mathop{\lim }}\left( 2u\dfrac{{\rm d}s}{{\rm d}u} \right)=-\dfrac{Q}{2\pi T}
\end{cases}
$$

原定解问题变为：

$$
\begin{cases}
u\dfrac{{\rm d}^2s}{{\rm d}u^2}+(1+u)\dfrac{{\rm d}s}{{\rm d}u}=0\\
\lim\limits_{u\to \infty }s=0\\
\lim\limits_{u\to0}\left( 2u\dfrac{{\rm d}s}{{\rm d}u} \right)=-\dfrac{Q}{2\pi T}
\end{cases}
$$

记 $s'=\frac{{\rm d}s}{{\rm d}u}$ ，方程变为：

$$
u\dfrac{{\rm d}s'}{{\rm d}u}+(1+u)s'=0
$$

分离变量：

$$
\frac{1}{s'}{\rm d}s'=-\left(1+\frac{1}{u}\right){\rm d}u
$$

等式两边同时积分：

$$
\ln s'=-\ln u-u+C
$$

即

$$
\frac{{\rm d}s}{{\rm d}u}=s'=e^{-\ln u -u-C}=C_1\frac{e^{-u}}{u}
$$

由边界条件

$$
-\frac{Q}{2\pi T}=2u\left.\frac{{\rm d}s}{{\rm d}u}\right|_{u=0}=2C_1
$$

得

$$
C_1=-\frac{Q}{4\pi T}
$$

因此

$$
\frac{{\rm d}s}{{\rm d}u}=-\frac{Q}{4\pi T}\frac{e^{-u}}{u}
$$

两边同时积分（注意对应的积分限），有

$$
\int_s^0 {\rm d}s=-\frac{Q}{4\pi T}\int_u^\infty\frac{e^{-u}}{u}{\rm d}u \implies s=\frac{Q}{4\pi T}\int_u^\infty \frac{e^{-u}}{u}{\rm d}u
$$

式中， $u=\frac{r^2}{4at}$。

### E2. Hankel 变换法

记

$$
\bar{s}(\beta,t)=\int_0^\infty srJ_0(\beta r){\rm d}r
$$

为 $s(r,t)$ 的 0 阶 Hankel 变换， $J_0(\beta r)$ 为第一类零阶 Bessel 函数。

将方程两端同乘以 $rJ_0(\beta r)$ ，并从 0 到 $\infty$ 对 $r$ 积分：

$$
a\int_0^\infty\frac{1}{r}\frac{\partial}{\partial r}\left(r\frac{\partial s}{\partial r}\right)rJ_0(\beta r){\rm d}r=\int_0^\infty\frac{\partial s}{\partial t}rJ_0(\beta r){\rm d}r
$$

等式右端：

$$
\int_0^\infty\frac{\partial s}{\partial t}rJ_0(\beta r){\rm d}r=\frac{\partial}{\partial t}\int_0^\infty srJ_0(\beta r){\rm d}r=\frac{{\rm d}\bar{s}}{{\rm d}t}
$$

等式左端分部积分：

$$
\begin{split}
a\int_0^\infty & \frac{1}{r}\frac{\partial}{\partial r}\left(r\frac{\partial s}{\partial r}\right)rJ_0(\beta r){\rm d}r\\
&=a\left.\left(r\frac{\partial s}{\partial r}\right)J_0(\beta r)\right|_0^\infty -a\int_0^\infty r \frac{\partial s}{\partial r}{\rm d}[J_0(\beta r)]\\
&=\frac{aQ}{2\pi T}+a\int_0^\infty r\frac{\partial s}{\partial r}
\beta J_1(\beta r){\rm d}r\\
&=\left.\frac{aQ}{2\pi T}+a\beta rJ_1(\beta r)s\right|_0^\infty-a\int_0^\infty s{\rm d}[\beta rJ_1(\beta r)]\\
&=\frac{aQ}{2\pi T}-a\int_0^\infty s\beta r J_0(\beta r){\rm d}[\beta r]\\
&=\frac{aQ}{2\pi T}-a\beta^2\bar{s}\\
\end{split}
$$

式中使用了 Bessel 函数的如下性质：

$$
\textcolor{red}{
J_0(0)=1,\quad J_0'(x)=-J_1(x),\quad \frac{{\rm d}}{{\rm d}x}[x^nJ_n(x)]=x^nJ_{n-1}(x)}
$$

Hankel 变换将原定解问题化为常微分方程的初值问题：

$$
\begin{cases}
\dfrac{{\rm d}\bar{s}}{{\rm d} t} + a\beta^2\bar{s}=\dfrac{aQ}{2\pi T}\\
\bar{s}\left.\right|_{t=0}=0
\end{cases}
$$

其解为：

$$
\bar{s}=\frac{aQ}{2\pi T}\int_0^t e^{-a\beta^2(t-\tau)}{\rm d} \tau
$$

通过 Hankel 逆变换求 $s$：

$$
\begin{split}
s & =\int_0^\infty \bar{s}\beta J_0(\beta r){\rm d}\beta \\
&=\frac{aQ}{2\pi T}\int_0^t\left[\int_0^\infty e^{-a\beta^2(t-\tau)}\beta J_0(\beta r){\rm d}\beta\right]{\rm d}\tau
\end{split}
$$

记

$$
F(r)=\int_0^\infty e^{-a\beta^2(t-\tau)}\beta J_0(\beta r){\rm d} \beta
$$

对 $F(r)$ 求导：  

$$
\begin{split}
F'(r) &=\int_0^\infty e^{-a\beta^2(t-\tau)}\beta[-J_1(\beta r)\beta]{\rm d} \beta\\
&=\frac{1}{2a(t-\tau)}\int_0^\infty \beta J_1(\beta r){\rm d} e^{-a\beta^2(t-\tau)}\\
&=\left.\frac{\beta J_1(\beta r)}{2a(t-\tau)}e^{-a\beta^2(t-\tau)}\right|_0^\infty-\frac{1}{2a(t-\tau)}\int_0^\infty e^{-a\beta^2(t-\tau)}\frac{1}{r}{\rm d}[\beta rJ_1(\beta r)]\\
&=-\frac{1}{2a(t-\tau)}\int_0^\infty e^{-a\beta^2(t-\tau)}\frac{1}{r}\beta r J_0(\beta r){\rm d}[\beta r]\\
&=-\frac{1}{2a(t-\tau)}\int_0^\infty e^{-a\beta^2(t-\tau)}\beta r J_0(\beta r){\rm d}\beta =-\frac{r}{2a(t-\tau)}F(r)
\end{split}
$$

式中使用了 Bessel 函数的如下性质：

$$
\textcolor{red}{
J_0(0)=1,\quad J_0'(x)=-J_1(x),\quad \frac{{\rm d}}{{\rm d}x}[x^nJ_n(x)]=x^nJ_{n-1}(x)}
$$

$F(r)$ 满足如下的常微分方程：

$$
F'(r)=-\frac{r}{2a(t-\tau)}F(r)
$$

分离变量：

$$
\frac{{\rm d}F(r)}{F(r)}=-\frac{r}{2a(t-\tau)}{\rm d}r
$$

两边积分：

$$
\ln F(r)=-\frac{r^2}{4a(t-\tau)}+C \implies F(r)=C_1e^{-\frac{r^2}{4a(t-\tau)}}
$$

$$
F(0)=\int_0^\infty e^{-a\beta^2(t-\tau)}\beta J_0(0){\rm d}\beta=\frac{1}{2a (t-\tau)} \implies C_1=\frac{1}{2a(t-\tau)}
$$

因此

$$
F(r)=\frac{1}{2a(t-\tau)}e^{-\frac{r^2}{4a(t-\tau)}}
$$

原问题的解

$$
s=\frac{aQ}{2\pi T}\int_0^t\frac{1}{2a(t-\tau)}e^{-\frac{r^2}{4a(t-\tau)}}{\rm d}\tau
$$

做变量代换，令

$$
y=\frac{r^2}{4a(t-\tau)},\quad {\rm d}\tau=\frac{r^2}{4ay^2}{\rm
d}y
$$

当 $\tau=0$ 时， $y=\frac{r^2}{4at}$ ，当 $\tau=t$ 时， $y=\infty$。因此

$$
s=\frac{aQ}{2\pi T}\int_{\frac{r^2}{4at}}^\infty \frac{2y}{r^2}e^{-y}\frac{r^2}{4ay^2}{\rm d}y=\frac{Q}{4\pi T}\int_u^\infty \frac{e^{-y}}{y}{\rm d}y
$$

式中， $u=\frac{r^2}{4at}$。

### E3. Laplace 变换法

偏微分方程：

$$
a\left(\frac{\partial^2s}{\partial r^2}+\frac{1}{r}\frac{\partial s}{\partial r}\right)=\frac{\partial s}{\partial t}
$$

记：

$$
\bar{s}(r,p)=\mathscr{L}\{s\}=\int_0^\infty s(r,t)e^{-pt}{\rm d}t
$$

对方程两边做 Laplace 变换：

$$
\text{左端}=a\left(\frac{{\rm d}^2\bar{s}}{{\rm d}r^2}+\frac{1}{r}\frac{{\rm d}\bar{s}}{{\rm d}r}\right),\quad \text{右端}=p\bar{s}-s(r,0)
$$

利用初始条件 $s(r,0)=0$ ，有：

$$
r^2\frac{{\rm d}^2\bar{s}}{{\rm d}r^2}+r\frac{{\rm d}\bar{s}}{{\rm d}r}-\frac{p}{a}r^2\bar{s}=0
$$

此为 0 阶修正 Bessel 方程，通解为：

$$
\bar{s}=C_1I_0\left(\sqrt{\frac{p}{a}}r\right)+C_2K_0\left(\sqrt{\frac{p}{a}}r\right)
$$

当 $r\to\infty$ 时， $s\to0\implies\bar{s}\to0$。又 $r\to\infty$ 时， $I_0\left(\sqrt{\frac{p}{a}}r\right)\to \infty$ ，有 $C_1=0$。

因此

$$
\bar{s}=C_2K_0\left(\sqrt{\frac{p}{a}}r\right)
$$

$$
\frac{{\rm d}\bar{s}}{{\rm d}r}=-C_2\sqrt{\frac{p}{a}}K_1\left(\sqrt{\frac{p}{a}}r\right)
$$

由内边界条件（抽水井），有

$$
r\left.\frac{{\rm d}\bar{s}}{{\rm d}r}\right|_{r=r_w}=-\frac{Q}{2\pi T}\frac{1}{p}
$$

$$
\begin{cases}
r^2\dfrac{{\rm d}^2\bar{s}}{{\rm d}r^2}+r\dfrac{{\rm d}\bar{s}}{{\rm d}r}-\dfrac{p}{a}r^2\bar{s}=0 \\
\lim\limits_{r\to\infty}\bar{s}=0 \\
\lim\limits_{r\to0}r\left(\dfrac{{\rm d}\bar{s}}{{\rm d}r}\right)=-\dfrac{Q}{2\pi T}\dfrac{1}{p}
\end{cases}
$$

得

$$
C_2=\frac{Q}{2\pi T}\frac{1}{p}\frac{1}{\sqrt{\frac{p}{a}}r_wK_1\left(\sqrt{\frac{p}{a}}r_w\right)}
$$

取 $r_w\to0$ ，根据 Bessel 函数的性质， $\underset{x\to 0}{\mathop{\lim }}xK_1(x)=1$ ，有

$$
\bar{s}\doteq \frac{Q}{4\pi T}\frac{2}{p}K_0\left(\sqrt{\frac{p}{a}}r\right)=\frac{Q}{4\pi T}\frac{r^2}{4a}\frac{2}{\frac{r^2}{4a}p}K_0\left(2\sqrt{\frac{r^2}{4a}p}\right)
$$

由 Laplace 逆变换

$$
\mathscr{L}^{-1}\left\{\frac{2}{p}K_0(2\sqrt{p})\right\}=E_1\left(\frac{1}{t}\right)
$$

及 Laplace 变换性质

$$
\mathscr{L}^{-1}\left\{F(bp)\right\}=\frac{1}{b}f\left(\frac{t}{b}\right)
$$

取 $b=\frac{r^2}{4a}$ ，有

$$
s=\frac{Q}{4\pi T}E_1\left(\frac{r^2}{4at}\right)=\frac{Q}{4\pi T}\int_{\frac{r^2S}{4Tt}}^\infty \frac{e^{-y}}{y}{\rm d}y
$$

### E4. 总结

| Bolttzmann 变换法                                                                                                                                                                                               | Hankel 变换法                                                                                                                | Laplace 变换法                                                                                                                                                                                                                                                  |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| $u(r,t)=R(r)T(t)=\frac{r^2}{4at}$                                                                                                                                                                            | $\bar{s}(\beta,t)=\int_0^\infty srJ_0(\beta r){\rm d}r$                                                                   | $\bar{s}(r,p)=\int_0^\infty s(r,t)e^{-pt}{\rm d}t$                                                                                                                                                                                                           |
| 边值问题                                                                                                                                                                                                         | 初值问题                                                                                                                      | 边值问题                                                                                                                                                                                                                                                         |
| $\begin{cases}u\frac{{\rm d}^2s}{{\rm d}u^2}+(1+u)\frac{{\rm d}s}{{\rm d}u}=0 \\ \lim\limits_{u\to \infty }s=0\\ \lim\limits_{u\to0}\left( 2u\frac{{\rm d}s}{{\rm d}u} \right)=-\frac{Q}{2\pi T}\end{cases}$ | $\begin{cases}\frac{{\rm d}\bar{s}}{{\rm d}t}+a\beta^2\bar{s}=\frac{aQ}{2\pi T}\\\lim\limits_{t\to0}\bar{s}=0\end{cases}$ | $\begin{cases}r^2\frac{{\rm d}^2\bar{s}}{{\rm d}r^2}+r\frac{{\rm d}\bar{s}}{{\rm d}r}-\frac{p}{a}r^2\bar{s}=0 \\\lim\limits_{r\to\infty}\bar{s}=0\\\lim\limits_{r\to0}r\left(\frac{{\rm d}\bar{s}}{{\rm d}r}\right)=-\frac{Q}{2\pi T}\frac{1}{p}\end{cases}$ |
|                                                                                                                                                                                                              | Hankel 逆变换                                                                                                                | Laplace 逆变换                                                                                                                                                                                                                                                  |
|                                                                                                                                                                                                              | $s(r,t)=\int_0^\infty \bar{s}\beta J_0(\beta r){\rm d}\beta$                                                              | $s(r,t)=\mathscr{L}^{-1}\{\bar{s}(r,p)\}$                                                                                                                                                                                                                    |

## F. Laplace 变换及应用

### F1. Laplace 变换简介

**Laplace 变换定义**

设函数 $f(t)$ 是定义在 $(0,\infty)$ 上的实值函数，如果对于复参数 $p=\beta+j\omega$ ，积分 $F(p)=\int_0^{+\infty}f(t)e^{-pt}{\rm d}t$ 在复平面 $p$ 的某一区域内收敛，则称 $F(p)$ 为 $f(t)$ 的 Laplace 变换，记为

$$
F(p)=\mathscr{L}\{f(t)\}=\int_0^{+\infty}f(t)e^{-pt}{\rm d}t
$$

相应地，称 $f(t)$ 为 $F(p)$ 的 Laplace 逆变换，记为

$$
f(t)=\mathscr{L}^{-1}\{F(p)\}
$$

**简单函数的 Laplace 变换**

$$
\begin{array}{ll}
(1)& \mathscr{L}\{1\} &= \int_0^{+\infty}e^{-pt}\mathrm{d}t = -\left.\frac{1}{p}e^{-pt}\right|_0^{+\infty}=\frac{1}{p} \\
(2)& \mathscr{L}\{e^{at}\} &= \int_0^{+\infty}e^{at}e^{-pt}\mathrm{d}t
=\left.\frac{1}{a-p}e^{(a-p)t}\right|_0^{+\infty}=\frac{1}{p-a},\quad(p>a)\\
(3)& \mathscr{L}\{\sin(at)\} &= \int_0^\infty\sin(at)e^{-pt}\mathrm{d}t
=-\frac{e^{-pt}}{p^2+a^2}\left[p\sin(at)+a\cos(at)\right]_0^\infty \\
& & =\frac{a}{p^2+a^2},\quad (p>0)\\
(4)& \mathscr{L}\{\cos(at)\} & =\int_0^\infty\cos(at)e^{-pt}\mathrm{d}t
=\frac{e^{-pt}}{p^2+a^2}\left[-p\cos(at)+a\sin(at)\right]_0^\infty \\
&&=\frac{p}{p^2+a^2},\qquad (p>0) \\
(5)& \mathscr{L}\{t^n\} &= \int_0^\infty t^ne^{-pt}\mathrm{d}t
= -n!e^{-pt}\sum_{m=0}^n \left. \frac{t^{n-m}}{(n-m)!p^{m+1}}\right|_0^\infty\\
&&=\frac{n!}{p^{n+1}},\quad (p>0) \\
\end{array}
$$

**特殊函数的 Laplace 变换**

- Heaviside 阶跃函数 (Heaviside step function)：

$$
H(t)=\begin{cases} 0& for\quad t<0\\
1& for\quad  t \ge 0\end{cases}
$$

Laplace变换：

$$
\mathscr{L}\{H(t-t_0)\}=\frac{1}{p}\exp(-pt_0),\quad s>0
$$

- $\delta$ 函数 (Dirac Delta function) 或脉冲函数 (Impulse function)：

$$
\delta(t)=\begin{cases} 0 & for\quad|t|>0 \\
\infty & for\quad t =0 \end{cases},\quad\int_{-\varepsilon}^\varepsilon\delta(t)\mathrm{d}t=1
$$

也可表示为

$$
\delta(t)=\begin{cases} 0 & for\quad|t|>\varepsilon \\
\frac{1}{2\varepsilon} & for\quad |t| \le\varepsilon \end{cases}, \quad \varepsilon\to 0
$$

$\delta$ 函数性质:

$$
\int_{-\infty}^\infty\delta(t) f(t)\mathrm{d}t=f(0)
$$

Laplace 变换:

$$
\begin{split}
\mathscr{L}\{\delta(t-t_0)\} & = \int_0^\infty \delta(t-t_0)e^{-pt}\mathrm{d}t = \lim_{\varepsilon\to 0}\int_{t_0-\varepsilon}^{t_0+\varepsilon}
\frac{e^{-pt}}{2\varepsilon}\mathrm{d}t \\
& =\lim_{\varepsilon\to 0} \frac{e^{-p(t_0-\varepsilon)}-e^{-p(t_0+\varepsilon)}}{2p\varepsilon} =e^{-pt_0} \\
\end{split}
$$

即

$$
\mathscr{L}\{\delta(t-t_0)\}= \exp(-pt_0)
$$

**Laplace 变换存在定理**

设函数 $f(t)(t\geq0)$ 满足：

1. 在任何有限区间上分段连续；
2. 即存在常数 $c$ 及 $M>0$ ，使得 $|f(t)|\leq Me^{ct}$。

则象函数 $F(p)$ 在半平面 ${\rm Re}~p>c$ 上一定存在且解析。

**Laplace 变换性质**
设

$$
F(p)=\mathscr{L}\{f(t)\}.\quad G(p)=\mathscr{L}\{g(t)\}
$$

- 线性性质

设 $a,~b$ 为常数，则有

$$
\mathscr{L}\{af(t)+bg(t)\}=aF(p)+bG(p)
$$

$$
\mathscr{L}^{-1}\{aF(p)+bG(p)\}=af(t)+bg(t)
$$

- 相似性质

设 $a$ 为任一正实数，则

$$
\mathscr{L}\{f(at)\}=\frac{1}{a}F\left(\frac{p}{a}\right)
$$

$$
\mathscr{L}^{-1}\{F(ap)\}=\frac{1}{a}f\left(\frac{t}{a}\right)
$$

- 延迟性质

设 $t<0$ 时， $f(t)=0$ ，则对任一非负实数 $\tau$ 有

$$
\mathscr{L}\{H(t-\tau)f(t-\tau)\}=e^{-p\tau}F(p)
$$

- 位移性质

设 $a$ 为任一复常数，则

$$
\mathscr{L}\{e^{at}f(t)\}=F(p-a)
$$

$$
\mathscr{L}\{e^{-at}f(t)\}=F(p+a)
$$

- 微分性质

$$
\begin{split}
\mathscr{L}\{f'(t)\}&=pF(p)-f(0)\\
\mathscr{L}\{f^{(n)}(t)\}&=p^nF(p)-p^{n-1}f(0)-p^{n-2}f'(0)-\cdots-f^{(n-1)}(0)\\
F'(p)&=-\mathscr{L}\{tf(t)\}\\
F^{(n)}(p)&=(-1)^n\mathscr{L}\{t^nf(t)\}\\
\end{split}
$$

- 积分性质

$$
\begin{split}
\mathscr{L}\left\{\int_0^tf(t)\mathrm{d}t\right\}&=\frac{1}{p}F(p)\\
\mathscr{L}\left\{\frac{1}{t}f(t)\right\}&=\int_p^\infty F(p)\mathrm{d}p
\end{split}
$$

设函数满足：$t<0$ 时 $f_1(t)=f_2(t)=0$ ，则定义卷积如下：

$$
\begin{aligned}
f_1(t)*f_2(t)& =\int_0^tf_1(\tau)f_2(t-\tau){\rm d}\tau\\
&=\int_0^tf_1(t-\tau)f_2(\tau){\rm d}\tau\\
\end{aligned}
$$

由上式给出的卷积满足交换律、结合律及分配律等性质。

- 卷积定理

$$
\mathscr{L}\{f_1(t)*f_2(t)\}=F_1(p)\cdot F_2(p)
$$

**Laplace 变换与逆变换简表**

| 序号   | $f(t)=\mathscr{L}^{-1}\{F(p)\}$                                                | $F(p)=\mathscr{L}\{f(t)\}$              |
|:----:|:------------------------------------------------------------------------------ |:--------------------------------------- |
| (1)  | $1$                                                                            | $\frac{1}{p}$                           |
| (2)  | $H(t-t_0)$                                                                     | $\frac{1}{p}\exp(-pt_0)$                |
| (3)  | $\delta(t-t_0)$                                                                | $\exp(-pt_0)$                           |
| (4)  | $t$                                                                            | $\frac{1}{p^2}$                         |
| (5)  | $t^\alpha$                                                                     | $\frac{\Gamma(\alpha+1)}{p^{\alpha+1}}$ |
| (6)  | $\exp(\alpha t)$                                                               | $\frac{1}{p-\alpha}$                    |
| (7)  | $t^n\exp(\alpha t)$                                                            | $\frac{n!}{(p-\alpha)^{n+1}}$           |
| (8)  | $\frac{1}{\sqrt{\pi t}}$                                                       | $\frac{1}{\sqrt{p}}$                    |
| (9)  | $2\sqrt{\frac{t}{\pi}}$                                                        | $p^{-3/2} $                             |
| (10) | $\frac{1}{2\sqrt{\pi t^3}}\exp\left(-\frac{1}{4t}\right)$                      | $\exp(-\sqrt{p})$                       |
| (11) | $\mathrm{erfc}\left(\frac{1}{2\sqrt{t}}\right)$                                | $\frac{1}{p}\exp(-\sqrt{p})$            |
| (12) | $\frac{1}{\sqrt{\pi t}}\exp\left(-\frac{1}{4t}\right)$                         | $\frac{1}{\sqrt{p}}\exp(-\sqrt{p}) $    |
| (13) | $ 2\sqrt{\frac{t}{\pi}}\exp(-\frac{1}{4t})-\mathrm{erfc}(\frac{1}{2\sqrt{t}})$ | $p^{-\frac{3}{2}}\exp(-\sqrt{p})$       |
| (14) | $t\exp(-t)$                                                                    | $\frac{1}{(p+1)^2}$                     |
| (15) | $\frac{1}{t}\exp(-\frac{1}{t})$                                                | $2K_0(2\sqrt{p})$                       |
| (16) | $E_1(\frac{1}{t})$                                                             | $\frac{2}{p}K_0(2\sqrt{p})$             |
| (17) | $\frac{1}{\sqrt{\pi}}\sin(2\sqrt{t})$                                          | $p^{-\frac{3}{2}}\exp(\frac{1}{p})$     |
| (18) | $\frac{1}{\sqrt{\pi}}\cos(2\sqrt{t})$                                          | $p^{-\frac{1}{2}}\exp(\frac{1}{p})$     |
| (19) | $-\gamma -\ln t$                                                               | $(\ln p)/p$                             |

表中：$H(t)$ — 单位阶跃函数；$\delta(t)$ — 单位阶跃函数； $\mathrm{erf}\,(t)=\frac{2}{\sqrt\pi}\int_0^t\exp(-y^2)\,\mathrm{d}y$ — 误差函数； $\mathrm{erfc}(t)=1-\mathrm{erf}(t)=\frac{2}{\sqrt \pi}\int_t^\infty\exp(-y^2)\,\mathrm{d}y$ — 余误差函数；$K_0$ — 第二类零阶修正 Bessel 函数； $E_1(t)=\int_t^{\infty}\frac{1}{y}\exp(-y)\,\mathrm{d}y$ — 指数积分； $\gamma = 0.577\,215\,6649 \cdots$ — 欧拉常数.

### F2. Laplace变换法求解偏微分方程

利用性质：$\mathscr{L}\{f'(t)\}=pF(p)-f(0)$ ，消除变量对t的导数。

<img title="" src="file:///D:/2023-地动/Appendix/md/figures/pde.png" alt="" width="500" data-align="center">

- 1 维问题（$\mathrm{I-1}$）：

$$
\left\{ \begin{array}{l}
   a \frac{\partial^2s}{\partial x^2} = \frac{\partial s}{\partial t} \\
   \mathrm{IC:}s(x,0)=0  \\
   \mathrm{BC:}s(0,t)=H  \\
   \mathrm{BC:}s(\infty ,t)=0  \\
\end{array} \right.
$$

对方程做 Laplace 变换，记：

$$
\bar{s}(x,p)=\mathscr{L}\{s(x,t)\}=\int_0^\infty s(x,t)\exp(-pt){\rm d}t
$$

有

$$
a\frac{{\rm d}^2\bar{s}(x,p)}{{\rm d}x^2}=p\bar{s}(x,p)-s(x,0)=p\bar{s}(x,p)
$$

上述方程的通解为

$$
\bar{s}(x,p)=C_1\exp\left(\sqrt{\frac{p}{a}}x\right)+C_2\exp\left(-\sqrt{\frac{p}{a}}x\right)
$$

对边界条件做 Laplace 变换：

$$
\left\{\begin{array}{l}
\bar{s}(\infty,p)=0\\
\bar{s}(0,p)=\frac{H}{p}\\
\end{array}\right.
$$

根据边界条件，有 $C_1=0,~C_2=\dfrac{H}{p}$ ， 因此

$$
\bar{s}(x,p)=H\frac{1}{p}\exp\left(
-\sqrt{\frac{p}{a}}x\right)
$$

根据 Laplace 变换简表公式（11）：

$$
L^{-1}\left\{\frac{1}{p}\exp(-\alpha\sqrt{p})\right\}={\rm erfc}\left(\frac{\alpha}{2\sqrt{t}}\right)
$$

取 $\alpha=\dfrac{x}{\sqrt{a}} $ ， 得

$$
s(x,t)=H~{\rm erfc}\left(\frac{x}{2\sqrt{at}}\right)
$$

- 1 维问题（$\mathrm{I-2}$）：

$$
\left\{ \begin{array}{l}
   a \frac{\partial^2s}{\partial x^2} = \frac{\partial s}{\partial t} \\
   \mathrm{IC:}s(x,0)=0  \\
   \mathrm{BC:}s(\infty ,t)=0  \\
   \mathrm{BC:}\left.\frac{\partial s}{\partial x}\right|_{x=0}=-\frac{q}{T}   \\
\end{array} \right.
$$

对方程做 Laplace 变换，记

$$
\bar{s}(x,p)=\mathscr{L}\{s(x,t)\}=\int_0^\infty s(x,t)\exp(-pt){\rm d}t
$$

有

$$
a\frac{{\rm d}^2\bar{s}(x,p)}{{\rm d}x^2}=p\bar{s}(x,p)-s(x,0)=p\bar{s}(x,p)
$$

上述方程的通解为

$$
\bar{s}(x,p)=C_1\exp\left(\sqrt{\frac{p}{a}}x\right)+
C_2\exp\left(-\sqrt{\frac{p}{a}}x\right)
$$

对边界条件做 Laplace 变换：

$$
\left\{\begin{array}{l}
\bar{s}(\infty,p)=0\\
\left.\frac{\partial\bar{s}}{\partial x}\right|_{x=0}=-\frac{1}{p}\frac{q}{T}\\
\end{array}\right.
$$

根据边界条件，有 $C_1=0,~C_2=\dfrac{q}{T}\sqrt{a} p^{-\frac{3}{2}}$ ， 因此

$$
\bar{s}(x,p)=\frac{q}{T}\sqrt{a} p^{-\frac{3}{2}}\exp\left(
-\sqrt{\frac{p}{a}}
x\right)
$$

根据 Laplace 变换简表公式（13）

$$
\mathscr{L}^{-1}\left\{p^{-\frac{3}{2}}\exp(-\alpha\sqrt{p})  \right\} = 2\sqrt{\frac{t}{\pi}}\exp\left(-\frac{\alpha^2}{4t}\right)-\alpha~{\rm erfc}\left(\frac{\alpha}{2\sqrt{t}}\right)
$$

取 $\alpha=\dfrac{x}{\sqrt{a}}$ ，得

$$
\begin{split}s(x,t)&=\frac{q}{T}\sqrt{a}\left[2\sqrt{\frac{t}{\pi}}
\exp\left(-\frac{x^2}{4at}\right)-\frac{x}{\sqrt{a}}{\rm erfc}\left(\frac{x}{2\sqrt{at}}\right)\right]\\
& = \frac{q}{T}\sqrt{\frac{4at}{\pi}}\exp\left(-\frac{x^2}{4at}\right)
-\frac{qx}{T}{\rm erfc}\left(\frac{x}{2\sqrt{at}}\right)\\
& = \frac{q}{T}\left[\frac{1}{\sqrt{\pi}u}\exp(-u^2)-{\rm erfc}(u)\right]
\end{split}
$$

式中， $u^2=\frac{x^2}{4at}$.

- 2 维问题（$\mathrm{II-1}$）：

记 $ s= H_0-H $ ，数学模型：

$$
\left\{\begin{array}{ll}
  a\left(\frac{\partial^2{s}}{\partial{r^2}}+\frac{1}{r}\frac{\partial{s}}{\partial{r}}\right)=
  \frac{\partial{s}}{\partial{t}}&t>0,~0<r<\infty\\
  \mathrm{IC:}s(r,0)=0&0<r<\infty\\
  \mathrm{BC:}s(\infty,t)=0,\lim\limits_{r\to\infty } \left(\frac{\partial{s}}{\partial{r}}\right)=0&t>0\\
  \mathrm{BC:}\lim\limits_{r\to 0} \left(r\frac{\partial{s}}{\partial{r}}\right)=-\frac{Q}{2\pi T}
\end{array}\right.
$$

式中， $a=\frac{T}{S}$。

记

$$
\bar{s(r,p)}=\mathscr{L}\{s\}=\int_0^\infty s(r,t)e^{-pt}{\rm d}t
$$

对方程两边做 Laplace 变换，并使用初始条件 $s(r,0)=0$ ，得：

$$
\frac{{\rm d}^2\bar{s}}{{\rm d}r^2}+\frac{1}{r}\frac{{\rm d}\bar{s}}{{\rm d}r}-\frac{p}{a}\bar{s}=0
$$

此为 0 阶修正 Bessel 方程，通解为：

$$
\bar{s}=C_1I_0\left(\sqrt{\frac{p}{a}}r\right)+C_2K_0\left(\sqrt{\frac{p}{a}}r\right)
$$

对边界条件做 Laplace 变换：

$$
\left\{\begin{array}{l}
\bar{s}(\infty,p)=0\\
\left.r\frac{\partial\bar{s}}{\partial r}\right|_{r=r_w}=-\frac{1}{p}\frac{Q}{2\pi T}\\
\end{array}\right.
$$

根据边界条件，有 $C_1=0,~C_2=\frac{Q}{2\pi T}\frac{1}{p}\frac{1}{\sqrt{\frac{p}{a}}r_wK_1\left(\sqrt{\frac{p}{a}}r_w\right)}$ ， 因此

$$
\bar{s}=\frac{Q}{2\pi T}\frac{1}{p}\frac{K_0\left(\sqrt{\frac{p}{a}}r\right)}{\sqrt{\frac{p}{a}}r_wK_1\left(\sqrt{\frac{p}{a}}r_w\right)}
$$

设 $r_w\to0$ ，因为 $\underset{x\to 0}{\mathop{\lim }}xK_1(x)=1$ ，所以有

$$
\bar{s}\doteq \frac{Q}{4\pi T}\frac{2}{p}K_0\left(\sqrt{\frac{p}{a}}r\right)
$$

根据 Laplace 变换简表公式（16）：

$$
\mathscr{L}^{-1}\left\{\frac{2}{p}K_0(2\sqrt{p})\right\}=E_1\left(\frac{1}{t}\right)
$$

及 Laplace 变换相似性：

$$
\mathscr{L}^{-1}\left\{F(bp)\right\}=\frac{1}{b}f\left(\frac{t}{b}\right)
$$

有

$$
\bar{s}\doteq \frac{Q}{4\pi T}\frac{2}{p}K_0\left(\sqrt{\frac{p}{a}}r\right)=\frac{Q}{4\pi T}\frac{r^2}{4a}\frac{2}{\frac{r^2}{4a}p}K_0\left(2\sqrt{\frac{r^2}{4a}p}\right)
$$

取 $b=\frac{r^2}{4a}$：

$$
s=\frac{Q}{4\pi T}E_1\left(\frac{r^2}{4at}\right)=\frac{Q}{4\pi T}\int_{\frac{r^2S}{4Tt}}^\infty \frac{e^{-y}}{y}{\rm d}y
$$

- 2 维问题（$\mathrm{II-2}$）：Jacob-Lohman 公式

做无量纲变量代换，记 $\bar{r}=\frac{r}{r_w},~\bar{t}= \frac{at}{r_w^2}$ ，定解问题变为

$$
\left\{\begin{array}{ll}
  \frac{\partial^2s}{\partial\bar{r}^2}+\frac{1}{\bar{r}}\frac{\partial s}{\partial\bar{r}}=
  \frac{\partial s}{\partial\bar{t}}&\bar{t}>0,~1<\bar{r}<\infty\\
  s(\bar{r},0)=0,&1<\bar{r}<\infty\\
  s(\infty,\bar{t})=0,&\bar{t}>0\\
  s(1,\bar{t})=s_w,&\bar{t}>0\\
\end{array}\right.
$$

对方程两边做 Laplace 变换，并使用初始条件 $s(r,0)=0$ ，得：

$$
\frac{{\rm d}^2\bar{s}}{{\rm d}\bar{r}^2}+\frac{1}{\bar{r}}\frac{{\rm d}\bar{s}}{{\rm d}\bar{r}}-p\bar{s}=0
$$

此为 0 阶修正 Bessel 方程，通解为：

$$
\bar{s}=C_1I_0\left(\sqrt{p}\bar{r}\right)+C_2K_0\left(\sqrt{p}\bar{r}\right)
$$

对边界条件做 Laplace 变换：

$$
\left\{\begin{array}{l}
\bar{s}(\infty,p)=0\\
\bar{s}(1,\bar{t})=\frac{s_w}{p}\\
\end{array}\right.
$$

根据边界条件，有 $C_1=0,~C_2=\frac{s_w}{p}\frac{1}{K_0(\sqrt{p})}$ ，因此

$$
\bar{s}=\frac{s_w}{p}\frac{K_0(\sqrt{p}\bar{r})}{K_0(\sqrt{p})}
$$

记

$$
\bar{A}(\bar{r},p)=\frac{K_0(\sqrt{p}\bar{r})}{pK_0(\sqrt{p})},\qquad \bar{s}=s_w \bar{A}(\bar{r},p)
$$

$$
A(\bar{r},\bar{t})=\mathscr{L}^{-1}\{\bar{A}(\bar{r},p)\}
$$

则有

$$
s=s_wA(\bar{r},\bar{t})
$$

式中， $A(\bar{r},\bar{t})$ 称为降深函数。

记 $Q_w$ 为自流井流量， $\bar{Q}_w$ 为 $Q_w$ 的 Laplace 变换。有

$$
\bar{Q}_w =-2\pi \bar{r} T\left.\frac{\partial \bar{s}}{\partial \bar{r}}\right|_{\bar{r}=1}=2\pi T\frac{s_w}{p}\frac{\sqrt{p}K_1(\sqrt{p})}{K_0(\sqrt{p})}
$$

记

$$
G(\bar{t})=\mathscr{L}^{-1}\left\{
\frac{K_1(\sqrt{p})}{\sqrt{p}K_0(\sqrt{p})}\right\}
$$

有

$$
Q_w=2\pi Ts_w G(\bar{t})
$$

式中， $G(\bar{t})$ 称为流量函数， $\bar{t}=\frac{at}{r_w^2}$。

- 2 维问题（$\mathrm{II-3}$）：Hantush-Jacob 公式

数学模型：

$$
\left\{\begin{array}{ll}
  \frac{\partial^2{s}}{\partial{r^2}}+
  \frac{1}{r}\frac{\partial{s}}{\partial{r}}
  -\frac{s}{B^2}=\frac{1}{a}  \frac{\partial{s}}{\partial{t}}&t>0,~r_w<r<\infty\\
  s(r,0)=0,&r_w<r<\infty\\
  s(\infty,t)=0,&t>0\\
  \lim\limits_{r\to 0}\left(s\frac{\partial s}{\partial t}\right)=-\frac{Q}{2\pi T},&t>0\\
\end{array}\right.
$$

式中， $a=\frac{T}{S}$。

对方程两边做 Laplace 变换，并使用初始条件 $s(r,0)=0$ ，得：

$$
\frac{\partial^2\bar{s}}{\partial{r^2}}+
  \frac{1}{r}\frac{\partial\bar{s}}{\partial{r}}
  -\left(\frac{p}{a}+\frac{1}{B^2}\right)\bar{s}=0
$$

同 Theis 模型，其解为：

$$
\bar{s}=\frac{Q}{4\pi T}\frac{2}{p}K_0\left(\sqrt{\frac{p}{a}+\frac{1}{B^2}}r\right)=\frac{Q}{4\pi T}\frac{2}{p}K_0\left(2\sqrt{\frac{r^2}{4a}\left(p+\frac{a}{B^2}\right)}\right)
$$

记 $\alpha=\frac{r^2}{4a},~\beta=\frac{a}{B^2}$ ，由 Laplace 变换简表公式（15）：

$$
\mathscr{L}^{-1}\{2K_0(2\sqrt{p})\} =\frac{1}{t}\exp\left(-\frac{1}{t}\right)=f(t)
$$

及相似性，有

$$
\mathscr{L}^{-1}\{2K_0(2\sqrt{\alpha p })\} =\frac{1}{\alpha}f\left(\frac{t}{\alpha}\right)=\frac{1}{t}\exp\left(-\frac{\alpha}{t}\right)
$$

根据位移性质，有

$$
\mathscr{L}^{-1}\{2K_0(2\sqrt{\alpha (p+\beta) })\}=\exp(-\beta t)\frac{1}{t}\exp\left(-\frac{\alpha}{t}\right)
=\frac{1}{t}\exp\left(-\beta t-\frac{\alpha}{t}\right)
$$

利用卷积计算 $\mathscr{L}^{-1}\{\frac{4\pi T \bar{s}}{Q}\}$：

$$
\frac{4\pi T s}{Q}=\int_0^t 1\cdot \frac{1}{\tau}\exp\left(-\beta \tau-\frac{\alpha}{\tau}\right)\mathrm{d}\tau
$$

做变量代换 $y=\frac{\alpha}{\tau}$：

$$
\begin{split}
\frac{4\pi T s}{Q} & =\int_\infty^{\frac{\alpha}{t}} \frac{y}{\alpha}\exp\left(-\frac{\alpha\beta}{y}-y\right)\left(-\frac{\alpha}{y^2}\right)\mathrm{d}y\\
&= \int_{\frac{r^2}{4at}}^\infty\frac{1}{y}\exp\left(-y-\frac{r^2}{4B^2y}\right)\mathrm{d}y
\end{split}
$$

### F3. Laplace变换的数值反演

**Stehfest 算法**

设 $F(p)$ 为函数 $f(t)$ 的 Laplace 变换。Stehfest 算法公式如下：

$$
f(t)\approx\frac{\ln 2}{t}\sum\limits_{i=1}^{n}
c_iF\left(\frac{i\ln 2}{t}\right)
$$

式中， $c_i$ 为 Stehfest 系数，按下式计算：

$$
c_i=(-1)^{i+\frac{n}{2}}\sum\limits_{k=\left[\frac{i+1}{2}\right]}^{min(i,\frac{n}{2})}
\frac{k^{\frac{n}{2}}(2k)!}{(\frac{n}{2}-k)!k!(k-1)!(i-k)!(2k-i)!}
$$

```vbscript
' n shuld not exceed about 20, and n = 10 is probably sufficient
' for most applications.
' Note that n must be an even integer and that t = time.
Function Lapinv(n,t)
  n=WorksheetFunction.Even(n)
  Lapinv=0#
  For i=1 To n
    Lapinv=Lapinv+Stehcoef(i,n)*Transform(i*Log(2)/t)
  Next i
  Lapinv=Lapinv*Log(2)/t
End Function

Function Stehcoef(i,n)
  M=WorksheetFunction.Round(n/2,0)
  upperlimit=WorksheetFunction.Min(i,M)
  lowerlimit=WorksheetFunction.RoundDown((i+1)/2,0)
  Stehcoef=0#
  For K=lowerlimit To upperlimit
    num=Fact(2*K)*K^M
    denom=Fact(M-K)*Fact(K)*Fact(K-1)*Fact(i-K)*Fact(2*K-i)
    Stehcoef=Stehcoef+num/denom
  Next K
  Stehcoef=Stehcoef*(-1)^(i+M)
End Function

Function Fact(x)
  Fact=WorksheetFunction.Fact(x)
End Function

Function Transform(p)  'Theis解
  Transform=2*WorksheetFunction.BesselK(2*Sqr(p),0)/p
End Function
```

- Theis 解的反演

$$
s=\frac{Q}{4\pi T}W(u)=\frac{Q}{4\pi T}\mathscr{L}^{-1}\left\{\frac{2}{p}K_0\left(\sqrt{\frac{p}{a}}r\right)\right\}
$$

式中， $u=\frac{r^2S}{4Tt}$。取 $b=\frac{r^2}{4a}$ ，得

$$
\frac{1}{b}W\left(\frac{1}{\frac{t}{b}}\right)=\mathscr{L}^{-1}\left\{\frac{2}{bp}K_0(2\sqrt{bp})\right\}
$$

由 Laplace 变换性质

$$
\mathscr{L}^{-1}\left\{F(bp)\right\}=\frac{1}{b}f\left(\frac{t}{b}\right)
$$

有

$$
W\left(\frac{1}{t^\ast}\right)=\mathscr{L}^{-1}\left\{\frac{2}{p^\ast}K_0(2\sqrt{p^\ast})\right\}=W(u)
$$

取 $u=0.01$ ，即 $t^\ast=\frac{1}{u}=100$ ，可以计算出 $W(0.01)$。

```vbscript
Function Transform(p)
  Transform=2*WorksheetFunction.BesselK(2*Sqr(p),0)/p
End Function
'
Function Lapinv(n,t)
  n=WorksheetFunction.Even(n)
  Lapinv=0#
  For i=1 To n
    Lapinv=Lapinv+Stehcoef(i,n)*Transform(i*Log(2)/t)
  Next i
  Lapinv=Lapinv*Log(2)/t
End Function
```

- 定降深井模型 (Jacob-Lohman) 反演

记

$$
\bar{A}(\bar{r},p)=\frac{K_0(\sqrt{p}\bar{r})}{pK_0(\sqrt{p})}
$$

有

$$
\bar{s}=s_w \bar{A}(\bar{r},p)
$$

记 $A(\bar{r},\bar{t})=\mathscr{L}^{-1}\{\bar{A}(\bar{r},p)\}$ ，得

$$
s=s_wA(\bar{r},\bar{t})
$$

式中， $A(\bar{r},\bar{t})$ 称为降深函数。

```vbscript
Function Transform(p,r)
  Transform=WorksheetFunction.BesselK(r*Sqr(p),0)/WorksheetFunction.BesselK(Sqr(p),0)/p
End Function
'
Function Lapinv(n,t,r)
  n=WorksheetFunction.Even(n)
  Lapinv=0#
  For i=1 To n
    Lapinv=Lapinv+Stehcoef(i,n)*Transform(i*Log(2)/t,r)
  Next i
  Lapinv=Lapinv*Log(2)/t
End Function
```

记 $Q_w$ 为自流井流量，有

$$
\begin{split}
Q_w&=2\pi Ts_w G(\bar{t})\\
&=2\pi Ts_w \mathscr{L}^{-1}\left\{
\frac{K_1(\sqrt{p})}{\sqrt{p}K_0(\sqrt{p})}\right\}
\end{split}
$$

式中， $G(\bar{t})$ 称为流量函数， $\bar{t}=\frac{at}{r_w^2}$。

```vbscript
Function Transform(p)
  s=Sqr(p)
  Transform=WorksheetFunction.BesselK(s,1)/WorksheetFunction.BesselK(s,0)/s
End Function
'
Function Lapinv(n,t)
  n=WorksheetFunction.Even(n)
  Lapinv=0#
  For i=1 To n
    Lapinv=Lapinv+Stehcoef(i,n)*Transform(i*Log(2)/t)
  Next i
  Lapinv=Lapinv*Log(2)/t
End Function
```

- 越流含水层完整井模型 (Hantush-Jacob) 反演

$$
s=\frac{Q}{4\pi T}W(u,\beta)=\frac{Q}{4\pi T}\mathscr{L}^{-1}\left\{\frac{2}{p}K_0\left(\sqrt{\frac{p}{a}+\frac{1}{B^2}}r\right) \right\}
$$

式中， $u=\frac{r^2S}{4Tt},~\beta=\frac{r}{B}$。取 $b=\frac{r^2}{4a}$ ，有：

$$
W\left(\frac{b}{t},\beta\right)=\mathscr{L}^{-1}\left\{\frac{2}{p}K_0\left(\sqrt{4bp+\beta^2}\right)\right\}
$$

由 Laplace 变换的相似性：

$$
\mathscr{L}^{-1}\left\{F(bp)\right\}=\frac{1}{b}f\left(\frac{t}{b}\right)
$$

得

$$
W\left(\frac{1}{t^\ast},\beta\right)=\mathscr{L}^{-1}\left\{\frac{2}{p^\ast}K_0\left(\sqrt{4p^\ast+\beta^2}\right)\right\}
$$

```vbscript
Function Transform(p,beta)
  Transform=2*WorksheetFunction.BesselK(Sqr(4*p+beta^2),0)/p
End Function
'
Function Lapinv(n,t,beta)
  n=WorksheetFunction.Even(n)
  Lapinv=0#
  For i=1 To n
    Lapinv=Lapinv+Stehcoef(i,n)*Transform(i*Log(2)/t,beta)
  Next i
  Lapinv=Lapinv*Log(2)/t
End Function
```
