---
jupyter:
  jupytext:
    formats: ipynb,md
    text_representation:
      extension: .md
      format_name: markdown
      format_version: '1.3'
      jupytext_version: 1.15.2
  kernelspec:
    display_name: Python 3 (ipykernel)
    language: python
    name: python3
---

# æœ€å°äºŒä¹˜æ³•ï¼šç¡®å®š $Q\sim s$ æ›²çº¿ç±»å‹


å¸¸è§çš„ $Q{\sim}s_w$ æ›²çº¿ç±»å‹

- **ç›´çº¿å‹ï¼š** $Q = qs_w$ 
- **æŠ›ç‰©çº¿å‹ï¼š** ${s_w} = aQ + b{Q^2}$ 
- **å¹‚å‡½æ•°å‹ï¼š** $Q = q_0 {s_w}^\frac{1}{m}$ 
- **å¯¹æ•°å‹ï¼š** $Q=a+b\lg s_w$ 


å°†å¸¸ç”¨çš„ $Q\sim s$ ç±»å‹å˜æ¢ä¸ºçº¿æ€§å½¢å¼ï¼š

- ç›´çº¿å‹ï¼š $Q = b s_w$ (ä¸å˜ï¼Œè¦æ±‚é€šè¿‡åŸç‚¹ï¼‰($b>0$)
- æŠ›ç‰©çº¿å‹ï¼š $\frac{s_w}{Q}=a+bQ$ï¼Œ($a>0$)
- å¹‚å‡½æ•°å‹ï¼š $\lg Q=a+b\lg{s_w}$ï¼Œï¼ˆå– $s_w=1$ å¯çŸ¥å¯¹ $a$ ç¬¦å·æ²¡æœ‰è¦æ±‚ï¼‰
- å¯¹æ•°å‹ï¼š $Q=a+b\lg s_w$ (ä¸å˜)ï¼Œï¼ˆå– $s_w=1$ å¯çŸ¥  $a>0$ ï¼‰


æ ¹æ®æœ€å°äºŒä¹˜æ³•åŸç†æ„é€ æ–¹ç¨‹ç»„ $X\beta = ğ‘Œ$ï¼Œ
è¿›ä¸€æ­¥å½¢æˆæ–¹ç¨‹ç»„ $ğ´\beta = ğ‘$ï¼Œè°ƒç”¨ `numpy.linalg.solve(a, b)` æ±‚è§£ï¼Œå…¶ä¸­ $ğ´ = X^ğ‘‡X, ğ‘ = X^ğ‘‡ğ‘Œ$ã€‚åˆ†åˆ«è®¡ç®—é™æ·±è¯¯å·®å¹³æ–¹å’Œ $\sum(ğ‘  âˆ’ \hat{s})^2$ï¼Œæœ€å°è€…ä¸ºæœ€ä¼˜ã€‚

<!-- #region -->
**ç»ƒä¹  1ï¼š** åœ¨åšåº¦ä¸º 16.50m çš„æ‰¿å‹å«æ°´å±‚ä¸­åšäº† 3 æ¬¡é™æ·±çš„æŠ½æ°´è¯•éªŒï¼Œå…¶ç»“æœè®°å½•åœ¨è¡¨ä¸­ã€‚è¯•æ±‚ $Q\sim s$ æ›²çº¿ã€‚


è¡¨ 1

$r_w(m)$ | $s_1(m)$ | $Q_1(m^3/d)$ | $s_2(m)$ | $Q_2(m^3/d)$ | $s_3(m)$ | $Q_3(m^3/d)$
---------|----------|--------------|----------|--------------|----------|-------------
 0.40 | 1.16 | 320.54 | 1.60 | 421.63 | 1.90 | 536.54


<!-- #endregion -->

**ç»ƒä¹  2ï¼š**

æŸç…¤çŸ¿å¯¹å¤ªåŸç»„å«æ°´å±‚å››ã€äº”ç°è¿›è¡Œäº†ç®€æ˜“ç¨³å®šæµæŠ½æ°´ï¼ŒæŠ½æ°´é‡ $(Q)$ã€æŠ½æ°´äº•é™æ·± $(s_w)$ã€æŠ½æ°´äº•åŠå¾„ $(r_w)$ã€å«æ°´å±‚åšåº¦ $(M)$ å¦‚è¡¨æ‰€ç¤ºã€‚è¯•ç¡®å®šæŠ½æ°´å­”çš„ $Q{\sim}s$ æ›²çº¿ç±»å‹å¹¶è®¡ç®—å«æ°´æ°´æ–‡åœ°è´¨å‚æ•°ã€‚

<center>
è¡¨ 2

 å­”å·  | $Q(m^3/d)$ | $s_w(m)$ | $r_w(m)$ | $M(m)$
-------|------------|---------|-----------|-----
 ä¸œ102 | 133.92     |  54.21  |  0.054  | 26.80
&nbsp; | 125.28     |  44.51  |  0.054  | 26.80
&nbsp; | 116.64     |  35.90  |  0.054  | 26.80
 è¥¿ 43 | 429.12     |  33.50  |  0.0445 | 34.90
&nbsp; | 495.36     |  40.40  |  0.0445 | 34.90
&nbsp; | 567.36     |  48.50  |  0.0445 | 34.90
</center>

<!-- #region -->
```python
# ç»ƒä¹  1 çš„æ•°æ®
Q = np.array([320.54, 421.63, 536.54])
s = np.array([1.16, 1.60, 1.90])
# ç»ƒä¹  2 çš„ä¸œ 102 æ•°æ®
Q = np.array([133.92, 125.28, 116.64])
s = np.array([54.21, 44.51, 35.90])
# ç»ƒä¹  2 çš„è¥¿ 43 æ•°æ®
Q = np.array([429.12, 495.36, 567.364])
s = np.array([33.50, 40.40, 48.50])
```
<!-- #endregion -->

```python
%matplotlib widget

# å¯¼å…¥ numpy ä¸ matplotlib åº“
import numpy as np
import matplotlib.pyplot as plt

# np.set_printoptions( ) æ§åˆ¶æ˜¾ç¤ºçš„å°æ•°ä½, é»˜è®¤ 8 ä½å°æ•°ä½. å¯ç”¨ formatter å‚æ•°è‡ªå®šä¹‰æ˜¾ç¤ºçš„æ ¼å¼
# ä¾‹å¦‚: np.set_printoptions(formatter={'float': '{:.2f}'.format})
np.set_printoptions(precision=4)

# (Q_i,s_i) æ•°æ®
Q = np.array([320.54, 421.63, 536.54])
s = np.array([1.16, 1.60, 1.90])

# ç›´çº¿å‹, ç›´æ¥æ±‚è§£
beta1 = s.dot(Q.T)/s.dot(s.T)

# æŠ›ç‰©çº¿å‹
# np.vstack æŒ‰å‚ç›´æ–¹å‘ï¼ˆè¡Œé¡ºåºï¼‰å †å æ•°ç»„æ„æˆä¸€ä¸ªæ–°çš„æ•°ç»„
X = np.vstack([np.ones(len(Q)), Q]).T  # å½¢æˆç³»æ•°
beta2 = np.linalg.solve(np.dot(X.T, X), np.dot(X.T, s/Q))

# å¹‚å‡½æ•°å‹
X = np.vstack([np.ones(len(Q)), np.log10(s)]).T  # å½¢æˆç³»æ•°
beta3 = np.linalg.solve(np.dot(X.T, X), np.dot(X.T, np.log10(Q)))

# å¯¹æ•°å‹
X = np.vstack([np.ones(len(Q)), np.log10(s)]).T  # å½¢æˆç³»æ•°
beta4 = np.linalg.solve(np.dot(X.T, X), np.dot(X.T, Q))

# Plot the data
fig, axs = plt.subplots(2, 2, figsize=(6, 4), dpi=150)

# ç›´çº¿å‹
axs[0,0].plot(s, Q, '*', label="ob")
x = np.linspace(np.min(s),np.max(s), 20)
axs[0,0].plot(x, beta1*x)
# set_title çš„ fontdict å‚æ•°æŒ‡å®šä¸­æ–‡å­—ä½“
axs[0,0].set_title("ç›´çº¿å‹",fontdict={'family': 'KaiTi'})
axs[0,0].set(xlabel=r'$s_w$', ylabel=r'$Q$')

# æŠ›ç‰©çº¿å‹
axs[0,1].plot(Q, s/Q, '*')
x = np.linspace(np.min(Q),np.max(Q), 20)
axs[0,1].plot(x, beta2[0]+beta2[1]*x)
axs[0,1].set_title("æŠ›ç‰©çº¿å‹",fontdict={'family': 'SimSun'})
axs[0,1].set(xlabel=r'$Q$', ylabel=r'$s_w/Q$')

# å¹‚å‡½æ•°å‹
axs[1,0].plot(np.log10(s), np.log10(Q), '*')
x = np.linspace(np.min(np.log10(s)),np.max(np.log10(s)), 20)
axs[1,0].plot(x, beta3[0]+beta3[1]*x)
axs[1,0].set_title("å¹‚å‡½æ•°å‹",fontdict={'family': 'Microsoft YaHei'})
axs[1,0].set(xlabel=r'$\lg s$', ylabel=r'$\lg Q$')

# å¯¹æ•°å‹
axs[1,1].plot(np.log10(s), Q, '*')
x = np.linspace(np.min(np.log10(s)),np.max(np.log10(s)), 20)
axs[1,1].plot(x, beta4[0]+beta4[1]*x)
axs[1,1].set_title("å¯¹æ•°å‹",fontdict={'family': 'SimHei'})
axs[1,1].set(xlabel=r'$\lg s$', ylabel=r'$Q$')

for ax in axs.flat:
    ax.grid()
     
plt.tight_layout()

# gcf() è·å–å½“å‰å›¾ç‰‡,  savefig( ) ä¿å­˜å›¾ç‰‡
fig = plt.gcf()
fig.savefig("fig2-2.png")

plt.show()

print('s è¯¯å·®å¹³æ–¹å’Œï¼š')
rss = sum((s - Q/beta1)**2)
print('  ç›´çº¿å‹:','beta = {:.4f},'.format(beta1),' RSS of s = {:.4e}'.format(rss))
rss = sum((s-beta2[0]*Q - beta2[1]*Q**2)**2)
print('  æŠ›ç‰©å‹:','beta = {},'.format(beta2),' RSS of s = {:.4e}'.format(rss))
rss = sum((np.float_power(10, (np.log10(Q) - beta3[0])/beta3[1]) - s)**2)
print('å¹‚å‡½æ•°å‹:','beta = {},'.format(beta3),' RSS of s = {:.4e}'.format(rss))
rss = sum((np.float_power(10, (Q - beta4[0])/beta4[1]) - s)**2)
print('  å¯¹æ•°å‹:','beta = {},'.format(beta4),' RSS of s = {:.4e}'.format(rss))
print()

print('Q è¯¯å·®å¹³æ–¹å’Œï¼š')
rss = sum((Q - s*beta1)**2)
print('  ç›´çº¿å‹:','beta = {:.4f},'.format(beta1),' RSS of Q = {:.4e}'.format(rss))
rss = sum(((-beta2[0]+np.sqrt(beta2[0]*beta2[0]+4*beta2[1]*s))/2/beta2[1]-Q)**2)
print('  æŠ›ç‰©å‹:','beta = {},'.format(beta2),' RSS of s = {:.4e}'.format(rss))
rss = sum((np.power(10,beta3[0])*np.power(s,beta3[1])-Q)**2)
print('å¹‚å‡½æ•°å‹:','beta = {},'.format(beta3),' RSS of s = {:.4e}'.format(rss))
ss = sum((beta4[0]+np.log10(s)*beta4[1]-Q)**2)
print('  å¯¹æ•°å‹:','beta = {},'.format(beta4),' RSS of s = {:.4e}'.format(rss))
```

**æ€è€ƒé¢˜**

(1) é€šè¿‡æ¯”è¾ƒï¼ŒæŠ›ç‰©çº¿å‹çš„ $s$ æˆ– $Q$ çš„è¯¯å·®å¹³æ–¹å’Œæœ€å°ã€‚é—®è¯¥äº•çš„ $Q\sim s$ æ›²çº¿ç¡®å®šä¸ºæŠ›ç‰©å‹æ˜¯å¦åˆé€‚ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ

(2) å¯¹æ¯”æŠ›ç‰©çº¿å‹çš„ $Q\sim s$ ä¸ C. E. Jacob äº•æŸè¡¨è¾¾å¼å¯ä»¥çœ‹å‡ºï¼Œå®ƒä»¬çš„å½¢å¼æ˜¯ä¸€æ ·çš„ã€‚è‹¥æŒ‰ä¸Šè¿°ç¤ºä¾‹æ•°æ®è®¡ç®—äº•æŸç³»æ•° $C$ï¼Œå‘ç° $C$ æ˜¯è´Ÿå€¼ï¼Œè¯•åˆ†æåŸå› ã€‚

(3) è‹¥å·²çŸ¥å«æ°´å±‚æŸé’»å­”çš„ $Q \sim s$ ç±»å‹ï¼Œé—®è¯¥ç±»å‹åŠæ•°æ®èƒ½å¦ç”¨äºé¢„æµ‹åŒå«æ°´å±‚å…¶å®ƒé’»å­”çš„é™æ·±ï¼Ÿ
